<!doctype html><html lang=fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Comparaison entre mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup | Les amis de Percona</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Comparaison des performances d'une sauvegarde à partir d'une base de données MySQL à l'aide de mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta name=generator content="Hugo 0.80.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/ananke/css/main.min.css><link rel="shortcut icon" href=/img/favicon.png type=image/x-icon><meta property="og:title" content="Comparaison entre mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta property="og:description" content="Comparaison des performances d'une sauvegarde à partir d'une base de données MySQL à l'aide de mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lesamisdepercona.fr/posts/sauvegarde-mysqldump-vs-mysql-shell-utilities-vs-mydumper-vs-mysqlpump-vs-xtrabackup/"><meta property="og:image" content="https://www.lesamisdepercona.fr/thumbnail2022/article10.jpg"><meta property="article:published_time" content="2022-03-08T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-08T00:00:00+00:00"><meta itemprop=name content="Comparaison entre mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta itemprop=description content="Comparaison des performances d'une sauvegarde à partir d'une base de données MySQL à l'aide de mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta itemprop=datePublished content="2022-03-08T00:00:00+00:00"><meta itemprop=dateModified content="2022-03-08T00:00:00+00:00"><meta itemprop=wordCount content="872"><meta itemprop=image content="https://www.lesamisdepercona.fr/thumbnail2022/article10.jpg"><meta itemprop=keywords content="MySQL,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.lesamisdepercona.fr/thumbnail2022/article10.jpg"><meta name=twitter:title content="Comparaison entre mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><meta name=twitter:description content="Comparaison des performances d'une sauvegarde à partir d'une base de données MySQL à l'aide de mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup"><script async src="https://www.googletagmanager.com/gtag/js?id=G-W9SYN1YL24"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-W9SYN1YL24');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-203534013-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-203534013-1');</script></head><body class="ma0 avenir bg-near-white"><header><div class=bg-dark-blue><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/img/logo.png class="w100 mw5-ns" alt="Les amis de Percona"></a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Articles page">Articles</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="Qui Sommes Nous? page">Qui Sommes Nous?</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/tags/ title="Tags page">Tags</a></li></ul></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://www.lesamisdepercona.fr/posts/sauvegarde-mysqldump-vs-mysql-shell-utilities-vs-mydumper-vs-mysqlpump-vs-xtrabackup/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://www.lesamisdepercona.fr/posts/sauvegarde-mysqldump-vs-mysql-shell-utilities-vs-mydumper-vs-mysqlpump-vs-xtrabackup/&text=Comparaison%20entre%20mysqldump%20vs%20MySQL%20Shell%20Utilities%20vs%20mydumper%20vs%20mysqlpump%20vs%20XtraBackup" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.lesamisdepercona.fr/posts/sauvegarde-mysqldump-vs-mysql-shell-utilities-vs-mydumper-vs-mysqlpump-vs-xtrabackup/&title=Comparaison%20entre%20mysqldump%20vs%20MySQL%20Shell%20Utilities%20vs%20mydumper%20vs%20mysqlpump%20vs%20XtraBackup" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Comparaison entre mysqldump vs MySQL Shell Utilities vs mydumper vs mysqlpump vs XtraBackup</h1><p class=tracked>By <strong>Francis</strong></p><time class="f6 mv4 dib tracked" datetime=2022-03-08T00:00:00Z>March 8, 2022</time>
<span class="f6 mv4 dib tracked">- 5 minutes read</span>
<span class="f6 mv4 dib tracked">- 872 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-100-l"><p><img src=/thumbnail2022/article10.jpg alt=thumbnail></p><p>Dans cet article de blog, nous comparerons les performances d&rsquo;une sauvegarde à partir d&rsquo;une base de données MySQL à l&rsquo;aide de <a href=https://dev.mysql.com/doc/refman/en/mysqldump.html>mysqldump </a>, de la fonctionnalité MySQL Shell appelée <a href=https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-utilities-dump-instance-schema.html>Instance Dump </a>, <a href=https://dev.mysql.com/doc/refman/8.0/en/mysqlpump.html>mysqlpump </a>, <a href=https://github.com/maxbube/mydumper>mydumper </a>et <a href=https://www.percona.com/software/mysql-database/percona-xtrabackup>Percona XtraBackup </a>. Toutes ces options disponibles sont open source et gratuites pour toute la communauté.</p><p>Pour commencer, voyons les résultats du test.</p><h2 id=résultats-de-benchmark>Résultats de Benchmark</h2><p>Le benchmark a été exécuté sur une instance <a href=https://aws.amazon.com/blogs/aws/new-m5n-and-r5n-instances-with-up-to-100-gbps-networking/>m5dn.8xlarge </a>, avec 128 Go de RAM, 32 vCPU et 2 disques NVMe de 600 Go (un pour la sauvegarde et l&rsquo;autre pour les données MySQL ). La version MySQL était 8.0.26 et configurée avec 89 Go de pool de mémoire tampon, 20 Go de journal de rétablissement et une base de données exemple de 177 Go (plus de détails ci-dessous).</p><p>Nous pouvons observer les résultats dans le tableau ci-dessous :</p><p><img src=/posts/2022/article10/img01.png alt=image01></p><p>Et si nous analysons le graphique uniquement pour les options multi-thread:</p><p><img src=/posts/2022/article10/img02.png alt=image02></p><p>Comme nous pouvons le voir, pour chaque logiciel, j&rsquo;ai exécuté chaque commande trois fois afin d&rsquo;expérimenter en utilisant 16, 32 et 64 threads. L&rsquo;exception à cela est mysqldump, qui n&rsquo;a pas d&rsquo;option parallèle et ne s&rsquo;exécute qu&rsquo;en mode monothread.</p><p>Nous pouvons observer des résultats intéressants :</p><ol><li>Lors de l&rsquo;utilisation de la compression zstd , mydumper brille vraiment en termes de performances. Cette option était ajouté il n&rsquo;y a pas longtemps ( <a href=https://www.percona.com/blog/mydumper-0-11-3-is-now-available/>MyDumper 0.11.3</a> ).</li><li>Lorsque mydumper utilise gzip , MySQL Shell est l&rsquo;option de sauvegarde la plus rapide.</li><li>En 3ème nous avons Percona XtraBackup .</li><li>mysqlpump est le 4ème plus rapide suivi de plus près par mydumper lors de l&rsquo;utilisation de gzip .</li><li>mysqldump est le style classique de la vieille école pour effectuer des vidages et est le plus lent des quatre outils.</li><li>Dans un serveur avec plus de processeurs, le parallélisme potentiel augmente, donnant encore plus d&rsquo;avantages aux outils qui peuvent bénéficier de plusieurs threads.</li></ol><h2 id=spécifications-matérielles-et-logicielles>Spécifications matérielles et logicielles</h2><p>Voici les spécifications du benchmark :</p><ul><li>32 CPUs</li><li>128 Go de mémoire</li><li>2x NVMe disques 600 Go</li><li>Centos 7.9</li><li>MySQL 8.0.26</li><li>MySQL Shell 8.0.26</li><li>mydumper 0.11.5 – gzip</li><li>mydumper 0.11.5 – zstd</li><li>Xtrabackup 8.0.26</li></ul><p>La configuration <code>my.cnf</code> :</p><pre><code>[mysqld]
innodb_buffer_pool_size = 89G
innodb_log_file_size = 10G
</code></pre><h2 id=test-de-performance>Test de performance</h2><p>Pour le test, j&rsquo;ai utilisé sysbench pour remplir MySQL. Pour charger les données, je choisis la méthode <a href=https://github.com/Percona-Lab/sysbench-tpcc>tpcc </a>:</p><pre><code>$ ./tpcc.lua  --mysql-user=sysbench --mysql-password='sysbench' --mysql-db=percona --time=300 --threads=64 --report-interval=1 --tables=10 --scale=100 --db-driver=mysql prepare
</code></pre><p>Avant de commencer la comparaison, j&rsquo;ai exécuté mysqldump une fois et j&rsquo;ai ignoré les résultats pour réchauffer le cache, sinon notre test serait biaisé car la première sauvegarde devrait récupérer les données du disque et non du cache.</p><p>Avec tout défini, j&rsquo;ai démarré le mysqldump avec les options suivantes :</p><pre><code>$ time mysqldump --all-databases --max-allowed-packet=4294967295 --single-transaction -R --master-data=2 --flush-logs | gzip &gt; /backup/dump.dmp.gz
</code></pre><p>Pour l&rsquo;utilitaire Shell:</p><pre><code>$ mysqlsh
MySQL JS &gt; shell.connect('root@localhost:3306');
MySQL localhost:3306 ssl test JS &gt; util.dumpInstance(&quot;/backup&quot;, {ocimds: true, compatibility: [&quot;strip_restricted_grants&quot;,&quot;ignore_missing_pks&quot;],threads: 16})
</code></pre><p>Pour <code>mydumper</code> :</p><pre><code>$ time mydumper  --threads=16  --trx-consistency-only --events --routines --triggers --compress --outputdir /backup/ --logfile /backup/log.out --verbose=2
</code></pre><p><em>PS : Pour utiliser zstd , il n&rsquo;y a aucun changement dans la ligne de commande, mais vous devez télécharger les <a href=https://github.com/mydumper/mydumper/releases>zstd binaires </a>.</em></p><p>Pour <code>mysqlpump</code> :</p><pre><code>$ time mysqlpump --default-parallelism=16 --all-databases &gt; backup.out
</code></pre><p>Pour <code>xtrabackup</code>:</p><pre><code>$ time xtrabackup --backup --parallel=16 --compress --compress-threads=16 --datadir=/mysql_data/ --target-dir=/backup/
</code></pre><h2 id=analyse-des-résultats>Analyse des résultats</h2><p>Et que nous disent les résultats ?</p><p>Les méthodes parallèles ont un débit de performances similaire. L' outil <code>mydumper</code> a réduit le temps d&rsquo;exécution de 50 % lors de l&rsquo;utilisation de <code>zstd</code> au lieu de <code>gzip</code> , de sorte que la méthode de compression fait une grande différence lors de l&rsquo;utilisation de <code>mydumper</code> .</p><p>Pour l’utilitaire <code>util.dumpInstance</code>, l&rsquo;un des avantages est que l&rsquo;outil stocke les données au format binaire et texte et utilise la compression <code>zstd</code> par défaut. Comme mydumper, il utilise plusieurs fichiers pour stocker les données et a un bon taux de compression.</p><p>XtraBackup a obtenu la troisième place avec quelques secondes de différence par rapport au MySQL shell. Le principal avantage de XtraBackup est sa flexibilité, fournissant le PITR et le chiffrement par exemple.</p><p>Ensuite, <code>mysqlpump</code> est plus efficace que mydumper avec <code>gzip</code> , mais seulement par une petite marge. Les deux sont des méthodes de sauvegarde logiques et fonctionnent de la même manière. J&rsquo;ai testé <code>mysqlpump</code> avec la compression <code>zstd</code>, mais les résultats étaient les mêmes, d&rsquo;où la raison pour laquelle je ne l&rsquo;ai pas ajouté au tableau. Une possibilité est que <code>mysqlpump</code> diffuse les données dans un seul fichier.</p><p>Enfin, pour <code>mysqldump</code>, nous pouvons dire qu&rsquo;il a le comportement le plus prévisible et a des temps d&rsquo;exécution similaires avec des exécutions différentes. Le manque de parallélisme et de compression est un inconvénient pour <code>mysqldump</code> ; cependant, comme il était présent dans les premières versions de MySQL, basé sur les cas Percona, il est toujours utilisé comme méthode de sauvegarde logique.</p><p>Veuillez laisser dans les commentaires ci-dessous ce que vous avez pensé de cet article de blog, si j&rsquo;ai raté quelque chose ou si cela vous a aidé. Je serai ravi d&rsquo;en discuter !</p><h2 id=ressources-utiles>Ressources utiles</h2><p>Enfin, vous pouvez nous joindre via les réseaux sociaux, notre forum, ou accéder à notre matériel en utilisant les liens présentés ci-dessous :</p><ul><li><a href=https://www.percona.com/blog/><strong>Blog</strong> </a></li><li><a href=https://www.percona.com/resources/solution-brief><strong>Solution Briefs</strong></a></li><li><a href=https://www.percona.com/resources/white-papers><strong>White Papers</strong></a></li><li><a href=https://www.percona.com/resources/ebooks><strong>Ebooks</strong></a></li><li><a href=https://www.percona.com/resources/technical-presentations><strong>Technical Presentations archive</strong></a></li><li><a href=https://www.percona.com/resources/videos><strong>Videos/Recorded Webinars</strong></a></li><li><a href=https://www.percona.com/forums/><strong>Forum</strong></a></li><li><a href=https://customers.percona.com/><strong>Knowledge Base (Percona Subscriber exclusive content)</strong></a></li></ul><ul class=pa0><li class=list><a href=/tags/mysql class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">MySQL</a></li></ul><div class="mt6 instapaper_ignoref"></div></div></article></main><footer class="bg-dark-blue bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.lesamisdepercona.fr/>&copy; Les amis de Percona 2022</a><div></div></div></footer></body></html>