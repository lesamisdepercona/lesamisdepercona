<!doctype html><html lang=en><head><meta charset=utf-8><link rel=stylesheet href=https://www.lesamisdepercona.fr//css/styles10.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel=stylesheet><link rel=stylesheet href=//use.fontawesome.com/releases/v5.11.2/css/all.css><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel=stylesheet><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=generator content="Hugo 0.82"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Les 18 astuces pour mettre au point votre base de données MySQL en heure de pointe (Partie 01)</title></head><body><header class=header><div class=logo><a class=toplogo href=/><img src=https://www.lesamisdepercona.fr//img/logo.png alt="Les amis de Percona"></a></div><div class=social><a href=https://www.facebook.com/lesamisdepercona/ target=_blank style=opacity:1><i class="fab fa-2x fa-facebook"></i></a><a href=https://github.com/lesamisdepercona/lesamisdepercona target=_blank style=opacity:1><i class="fab fa-2x fa-github"></i></a><a href=https://linkedin.com/in/lesamisdepercona/ target=_blank style=opacity:1><i class="fab fa-2x fa-linkedin"></i></a><a href=https://twitter.com/amisdepercona target=_blank style=opacity:1><i class="fab fa-2x fa-twitter"></i></a></div></header><div class=nav><ul class=navtop><li><a href=https://www.percona.com/>Percona Web</a></li><li><a href=/tags/>Tags</a></li><li><a href=/categories/>Categories</a></li><li><a href=/posts/>Tous Nos Articles</a></li><li><a href=/>Accueil</a></li></ul></div><section class=blogphotoslidearticle><div class=homeslidetext><h1 class=slidetitlesinglelisth1>Les amis de Percona :</h1><h2 class=slidetitleh2>Blog dédié à la Base de Donnée OpenSource</h2></div></section><article class=single-post><h1 class=entry-title>Les 18 astuces pour mettre au point votre base de données MySQL en heure de pointe (Partie 01)</h1><div class=post-meta><span class=post-date><time>10 April, 2021</time></span>
<span class=post-tags><a href=https://www.lesamisdepercona.fr/tags/mysql/>mysql</a></span>
<span class=post-categories></span><div class=post-author>Posté par :</div></div><hr color=#3b5998 #width=100%><div class=entry-content><h3 id=les-18-choses-que-vous-pouvez-faire-pour-supprimer-les-goulots-d39étranglement-mysql-causés-par-un-trafic-élevé-partie-01>Les 18 choses que vous pouvez faire pour supprimer les goulots d'étranglement MySQL causés par un trafic élevé (Partie 01)</h3><p><em>Cet article est divisé en trois parties. La deuxième partie se trouve <a href=/post/article02_mysql-18astuces_heure_de_pointe_part2/>ici</a>, et la troisième partie se trouve <a href=/post/article02_mysql-18astuces_heure_de_pointe_part3/>ici</a></em></p><p>Il n'y avait aucune raison de le planifier, mais la charge sur votre système a augmenté de 100%, 300%, 500% et votre base de données MySQL doit la supporter. C'est une réalité à laquelle de nombreux systèmes en ligne doivent faire face ces jours-ci. Cette série se concentre sur la gestion de l'événement inattendu à fort trafic au fur et à mesure qu'il se produit.</p><p>Il y a aussi beaucoup de choses que vous pouvez faire de manière proactive, que nous avons abordées dans «<a href=https://www.percona.com/blog/2019/11/11/prepare-your-databases-for-high-traffic-on-black-friday/>Préparez vos bases de données pour un trafic élevé du Black Friday</a>».</p><p>Tout d'abord, voyons quel impact un pic de trafic peut-il avoir sur la base de données ? Quels problèmes votre équipe d'ingénieurs d'application verra-t-elle probablement?</p><ul><li><p>Mauvais temps de réponse aux requêtes</p></li><li><p>Taux d'erreur élevé (connexion à la base de données et exécution de requêtes)</p></li><li><p>La base de données se plante (indisponible)</p></li><li><p>Données incorrectes (obsolètes) en raison d'un retard de réplication ou de travaux par lots incapables de se terminer</p></li></ul><p>L'objectif immédiat de la gestion de pic de trafic est d'éliminer ces problèmes le plus rapidement possibles, ce qui, pour la plupart des équipes, signifie se concentrer sur les «outils à portée de main» - des solutions qui peuvent être déployées en quelques heures ou quelques jours, et qui ne nécessitent pas une application massive ou des changements d'infrastructure.</p><p>La bonne nouvelle est que pour la majorité des applications, vous pouvez améliorer de façon significative la capacité de la base de données en effectuant quelques actions très simples:</p><p><strong>1. Ajustez la taille de votre instance cloud</strong></p><p><em>Complexité: faible</em></p><p><em>Impact potentiel: élevé</em></p><p>Si vous exécutez dans le cloud (ou dans un environnement virtualisé), passer à une taille d'instance plus grande (également appelée «réglage par carte de crédit») est souvent la chose la plus simple que vous puissiez faire. C'est l'une des choses les plus coûteuses que vous puissiez faire, mais c'est une action à court terme que vous pouvez entreprendre pendant que vous procédez à la mise en œuvre d'autres actions d'optimisation des performances.</p><p>Remarque: les bases de données n'ont pas tendance à évoluer de manière linéaire, alors ne vous laissez pas convaincre par un faux sentiment de sécurité - si votre fournisseur de cloud dispose d'instances 10 fois plus grandes, ne vous attendez pas à ce qu'il gère un trafic 10x de plus. Cela peut être beaucoup moins en fonction du volume de travail.</p><p><strong>2. Déployez plus de MySQL Slaves / Replicas</strong></p><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: élevé</em></p><p>Si votre volume de travail est gourmande en lecture, déployer davantage de réplicas peut être un excellent moyen d'améliorer les performances. Si vous ne savez pas quel type de volume de travail vous avez, notre article «<a href=https://www.percona.com/blog/2018/08/30/read-intensive-or-write-intensive-workload/>Est-ce un volume de travail intensif en lecture ou en écriture</a>» pourrait vous aider à le comprendre.</p><p>Le déploiement de Replicas n'est cependant pas suffisant; vous devez vous assurer que votre application soit capable de leur fournir suffisamment assez de trafic. Dans certains cas, l'activation de cette fonctionnalité pourrait être facile au niveau de l'application. Pour d'autres, déployer ProxySQL et utiliser sa <a href=https://proxysql.com/blog/configure-read-write-split/>fonctionnalité de fractionnement en lecture-écriture</a> pourrait être beaucoup plus adequat.</p><p>Dans de nombreux cas, vous pouvez même déplacer des applications complètes vers des Replicas : il faudrait alors recourir à des applications de reporting ou des applications utilisant la recherche en texte intégral MySQL.</p><p>Gardez à l'esprit que la réplication MySQL est asynchrone, ce qui signifie que les replicas auront des données propagées avec un retard (parfois important), par conséquent, acheminez uniquement les requêtes vers des replicas qui peuvent tolérer des données non à jour et assurez-vous de surveiller le retard de réplication et l'état général.</p><p><strong>3. Déployer ProxySQL pour la gestion des connexions et de mise en cache</strong></p><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: élevé</em></p><p>ProxySQL est un excellent outil pour aider à gérer le trafic MySQL, en particulier lors des pics de trafic. ProxySQL peut aider par exemple grâce au <a href=https://www.percona.com/resources/webinars/utilizing-proxysql-connection-pooling-php>pool de connexions</a> afin que l'application ne soit pas à court de connexions et ne surcharge pas MySQL en ayant trop de connexions simultanées.</p><p>Si vous exécutez <a href=https://www.percona.com/software/mysql-database/percona-server>Percona Server pour MySQL</a> ou MariaDB, vous pouvez également activer <a href=https://www.percona.com/doc/percona-server/LATEST/performance/threadpool.html>ThreadPool</a> qui peut permettre à une <a href=https://www.percona.com/blog/2019/02/25/mysql-challenge-100k-connections/>instance MySQL de gérer directement plus de 100 000 connexions</a>.</p><p>Une autre fonctionnalité de ProxySQL qui peut être encore plus utile lors des pics de trafic est <a href=https://www.percona.com/blog/2018/02/07/proxysql-query-cache/>ProxySQL Query Cache</a>, qui vous permet de mettre en cache les résultats des requêtes pendant un certain temps.</p><p>Lorsque vous trouvez des requêtes qui n'ont pas absolument besoin de fournir des résultats complètement à jour, dirigez-les vers des répliques MySQL où vous pouvez mettre en cache les mêmes requêtes pour un avantage supplémentaire.</p><p><strong>4. Désactiver les fonctionnalités des applications à charge lourde</strong></p><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: moyen</em></p><p>Les équipes de gestion et de développement détesteront souvent de telles idées, mais c'est un excellent outil. Toutes les fonctionnalités de l'application n'offrent pas la même valeur ou ne sont pas utilisées à la même fréquence, mais ce sont des fonctionnalités avancées, rarement appliquées, qui peuvent souvent être les plus coûteuses, car peu de temps a été passé à les optimiser. Les désactiver, au moins temporairement, pendant que vous traversez des pics de trafic ou que vous trouvez un moment pour les optimiser, est souvent une bonne chose à faire.</p><p>Il ne s'agit forcement pas des fonctionnalités destinées aux utilisateurs - pensez à identifier s'il existe des rapports internes dont vous pouvez vous passer?</p><p><strong>5. Vérifiez les goulots d'étranglement des ressources</strong></p><p><em>Complexité: faible</em></p><p><em>Impact potentiel: élevé</em></p><p>Les bases de données de niveau matériel sont susceptibles d'être bloquées par une (ou plusieurs) ressources principales - CPU, mémoire, disque ou réseau. Si vous exécutez <a href=https://www.percona.com/software/database-tools/percona-monitoring-and-management>Percona Monitoring and Management (PMM</a>), vous pouvez les voir dans la section Récapitulatif des nœuds de votre tableau de bord récapitulatif des instances MySQL.</p><p><img src=/images/article02/p01_image01.png alt="image 01"></p><p>Si une ressource particulière est saturée, vous pouvez généralement obtenir de meilleures performances en augmentant cette ressource, bien que se concentrer sur la réduction de l'utilisation de cette ressource soit une autre alternative. Par exemple, un problème d'utilisation élevée du processeur est souvent mieux résolu en optimisant vos requêtes plutôt qu'en obtenant un processeur plus rapide.</p><p><strong>6. Obtenez plus de cœurs ou des cœurs plus rapides</strong></p><p><em>Complexité: faible</em></p><p><em>Impact potentiel: moyen</em></p><p>Une chose importante à savoir à propos de MySQL est qu'il ne peut utiliser qu'un seul cœur de processeur pour effectuer la plupart du travail d'exécution d'une seule requête, ce qui signifie que l'obtention de plus de cœurs de processeur ne rend souvent pas vos requêtes lentes ou vos travaux par lots exécutant de nombreuses requêtes séquentiellement plus rapide. Si tel est votre problème, vous devez vous concentrer sur l'obtention de cœurs de processeur plus rapides ou vous devriez peut-être vous concentrer sur l'obtention de plus de cœurs.</p><p>Mais comment savoir quel type de charge de travail vous exécutez?</p><p>Jetez un œil à votre utilisation du processeur, à la saturation du processeur et à l'utilisation maximale du cœur dans le résumé des nœuds de Percona Monitoring and Management (ou graphique comparable dans votre système de surveillance préféré).</p><p><img src=/images/article02/p01_image02.png alt="image 02"></p><p>Si l'utilisation du processeur est élevée (à l'exclusion de IO wait) et si la charge de processeur normalisée est supérieure ou égale à 2, votre système pourrait avoir besoin plus de cœurs de processeur disponibles pour exécuter un volume de travail.</p><p>Si, cependant, l'utilisation maximale du cœur du processeur est plus proche de 100% et que votre utilisation du processeur n'est pas élevée, vous devez vous concentrer sur des cœurs plus rapides.</p><p>Par exemple, si vous exécutez sur AWS, le <a href=https://aws.amazon.com/ec2/instance-types/>type d'instance</a> Cloud C5 offre des performances de processeur supérieures par rapport au type d'instance M5 à usage général.</p><p>Une autre chose à surveiller en ce qui concerne le processeur, en particulier dans le cloud et les environnements virtualisés, est le «vol de processeur» - cela peut laisser votre instance MySQL avec beaucoup moins de ressources processeur que la fréquence du processeur et le nombre de cœurs indiqué. Lisez «<a href=https://www.percona.com/blog/2019/11/04/choose-your-ec2-instance-type-wisely-on-aws/>Choisissez judicieusement votre type d'instance EC2 sur AWS</a>» pour plus de détails.</p><p>Page source : <a href=https://www.percona.com/blog/2020/04/03/18-things-you-can-do-to-remove-mysql-bottlenecks-caused-by-high-traffic-part-one/>Percona Blog</a></p></div></article><hr color=#3b5998 #width=100%><footer>Copyright &copy; - 2021 - Focus Dev</footer></body></html>