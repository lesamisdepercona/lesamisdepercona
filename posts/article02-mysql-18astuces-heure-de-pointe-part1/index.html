<!doctype html><html lang=fr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Base de données open source : Améliorer la performance de MySQL (Partie 01) | Les amis de Percona</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Astuces et conseils pour améliorer la performance de votre base de donnée MySQL en heure de pointe"><meta name=generator content="Hugo 0.80.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/ananke/css/main.min.css><link rel="shortcut icon" href=/img/favicon.png type=image/x-icon><meta property="og:title" content="Base de données open source : Améliorer la performance de  MySQL (Partie 01)"><meta property="og:description" content="Astuces et conseils pour améliorer la performance de votre base de donnée MySQL en heure de pointe"><meta property="og:type" content="article"><meta property="og:url" content="https://www.lesamisdepercona.fr/posts/article02-mysql-18astuces-heure-de-pointe-part1/"><meta property="og:image" content="https://www.lesamisdepercona.fr/thumbnail/amisdepercona21-002.jpg"><meta property="article:published_time" content="2021-04-10T11:43:01+04:00"><meta property="article:modified_time" content="2021-04-10T11:43:01+04:00"><meta itemprop=name content="Base de données open source : Améliorer la performance de  MySQL (Partie 01)"><meta itemprop=description content="Astuces et conseils pour améliorer la performance de votre base de donnée MySQL en heure de pointe"><meta itemprop=datePublished content="2021-04-10T11:43:01+04:00"><meta itemprop=dateModified content="2021-04-10T11:43:01+04:00"><meta itemprop=wordCount content="1375"><meta itemprop=image content="https://www.lesamisdepercona.fr/thumbnail/amisdepercona21-002.jpg"><meta itemprop=keywords content="mysql,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.lesamisdepercona.fr/thumbnail/amisdepercona21-002.jpg"><meta name=twitter:title content="Base de données open source : Améliorer la performance de  MySQL (Partie 01)"><meta name=twitter:description content="Astuces et conseils pour améliorer la performance de votre base de donnée MySQL en heure de pointe"><script async src="https://www.googletagmanager.com/gtag/js?id=G-W9SYN1YL24"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-W9SYN1YL24');</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-203534013-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-203534013-1');</script></head><body class="ma0 avenir bg-near-white"><header><div class=bg-dark-blue><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/img/logo.png class="w100 mw5-ns" alt="Les amis de Percona"></a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Articles page">Articles</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="Qui Sommes Nous? page">Qui Sommes Nous?</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/tags/ title="Tags page">Tags</a></li></ul></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class=mt3><a href="https://www.facebook.com/sharer.php?u=https://www.lesamisdepercona.fr/posts/article02-mysql-18astuces-heure-de-pointe-part1/" class="facebook no-underline" aria-label="share on Facebook"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765 50.32h6.744V33.998h4.499l.596-5.624h-5.095l.007-2.816c0-1.466.14-2.253 2.244-2.253h2.812V17.68h-4.5c-5.405.0-7.307 2.729-7.307 7.317v3.377h-3.369v5.625h3.369V50.32zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></a><a href="https://twitter.com/share?url=https://www.lesamisdepercona.fr/posts/article02-mysql-18astuces-heure-de-pointe-part1/&text=Base%20de%20donn%c3%a9es%20open%20source%20:%20Am%c3%a9liorer%20la%20performance%20de%20%20MySQL%20%28Partie%2001%29" class="twitter no-underline" aria-label="share on Twitter"><svg height="32" style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://www.lesamisdepercona.fr/posts/article02-mysql-18astuces-heure-de-pointe-part1/&title=Base%20de%20donn%c3%a9es%20open%20source%20:%20Am%c3%a9liorer%20la%20performance%20de%20%20MySQL%20%28Partie%2001%29" class="linkedin no-underline" aria-label="share on LinkedIn"><svg height="32" style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" width="32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30C64 50.568 50.568 64 34 64zM26.354 48.137V27.71h-6.789v20.427H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:"/></svg></a></div><h1 class="f1 athelas mt3 mb1">Base de données open source : Améliorer la performance de MySQL (Partie 01)</h1><p class=tracked>By <strong>Francis</strong></p><time class="f6 mv4 dib tracked" datetime=2021-04-10T11:43:01+04:00>April 10, 2021</time>
<span class="f6 mv4 dib tracked">- 7 minutes read</span>
<span class="f6 mv4 dib tracked">- 1375 words</span></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-100-l"><h3 id=les-18-choses-que-vous-pouvez-faire-pour-supprimer-les-goulots-détranglement-mysql-causés-par-un-trafic-élevé-partie-01>Les 18 choses que vous pouvez faire pour supprimer les goulots d’étranglement MySQL causés par un trafic élevé (Partie 01)</h3><p><em>Cet article est divisé en trois parties. La deuxième partie se trouve <a href=/posts/article02-mysql-18astuces-heure-de-pointe-part2/>ici</a>, et la troisième partie se trouve <a href=/posts/article02-mysql-18astuces-heure-de-pointe-part3/>ici</a></em></p><p>Il n’y avait aucune raison de le planifier, mais la charge sur votre système a augmenté de 100%, 300%, 500% et votre base de données MySQL doit la supporter. C’est une réalité à laquelle de nombreux systèmes en ligne doivent faire face ces jours-ci. Cette série se concentre sur la gestion de l’événement inattendu à fort trafic au fur et à mesure qu’il se produit.</p><p>Il y a aussi beaucoup de choses que vous pouvez faire de manière proactive, que nous avons abordées dans «<a href=https://www.percona.com/blog/2019/11/11/prepare-your-databases-for-high-traffic-on-black-friday/>Préparez vos bases de données pour un trafic élevé du Black Friday</a>».</p><p>Tout d’abord, voyons quel impact un pic de trafic peut-il avoir sur la base de données ? Quels problèmes votre équipe d’ingénieurs d’application verra-t-elle probablement?</p><ul><li><p>Mauvais temps de réponse aux requêtes</p></li><li><p>Taux d’erreur élevé (connexion à la base de données et exécution de requêtes)</p></li><li><p>La base de données se plante (indisponible)</p></li><li><p>Données incorrectes (obsolètes) en raison d’un retard de réplication ou de travaux par lots incapables de se terminer</p></li></ul><p>L’objectif immédiat de la gestion de pic de trafic est d’éliminer ces problèmes le plus rapidement possibles, ce qui, pour la plupart des équipes, signifie se concentrer sur les «outils à portée de main» - des solutions qui peuvent être déployées en quelques heures ou quelques jours, et qui ne nécessitent pas une application massive ou des changements d’infrastructure.</p><p>La bonne nouvelle est que pour la majorité des applications, vous pouvez améliorer de façon significative la capacité de la base de données en effectuant quelques actions très simples:</p><h4 id=1-ajustez-la-taille-de-votre-instance-cloud>1. Ajustez la taille de votre instance cloud</h4><p><em>Complexité: faible</em></p><p><em>Impact potentiel: élevé</em></p><p>Si vous exécutez dans le cloud (ou dans un environnement virtualisé), passer à une taille d’instance plus grande (également appelée «réglage par carte de crédit») est souvent la chose la plus simple que vous puissiez faire. C’est l’une des choses les plus coûteuses que vous puissiez faire, mais c’est une action à court terme que vous pouvez entreprendre pendant que vous procédez à la mise en œuvre d’autres actions d’optimisation des performances.</p><p>Remarque: les bases de données n’ont pas tendance à évoluer de manière linéaire, alors ne vous laissez pas convaincre par un faux sentiment de sécurité - si votre fournisseur de cloud dispose d’instances 10 fois plus grandes, ne vous attendez pas à ce qu’il gère un trafic 10x de plus. Cela peut être beaucoup moins en fonction du volume de travail.</p><h4 id=2-déployez-plus-de-mysql-réplicas>2. Déployez plus de MySQL Réplicas</h4><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: élevé</em></p><p>Si votre volume de travail est gourmande en lecture, déployer davantage de réplicas peut être un excellent moyen d’améliorer les performances. Si vous ne savez pas quel type de volume de travail vous avez, notre article «<a href=https://www.percona.com/blog/2018/08/30/read-intensive-or-write-intensive-workload/>Est-ce un volume de travail intensif en lecture ou en écriture</a>» pourrait vous aider à le comprendre.</p><p>Le déploiement de Replicas n’est cependant pas suffisant; vous devez vous assurer que votre application soit capable de leur fournir suffisamment assez de trafic. Dans certains cas, l’activation de cette fonctionnalité pourrait être facile au niveau de l’application. Pour d’autres, déployer ProxySQL et utiliser sa <a href=https://proxysql.com/blog/configure-read-write-split/>fonctionnalité de fractionnement en lecture-écriture</a> pourrait être beaucoup plus adequat.</p><p>Dans de nombreux cas, vous pouvez même déplacer des applications complètes vers des Replicas : il faudrait alors recourir à des applications de reporting ou des applications utilisant la recherche en texte intégral MySQL.</p><p>Gardez à l’esprit que la réplication MySQL est asynchrone, ce qui signifie que les replicas auront des données propagées avec un retard (parfois important), par conséquent, acheminez uniquement les requêtes vers des replicas qui peuvent tolérer des données non à jour et assurez-vous de surveiller le retard de réplication et l’état général.</p><h4 id=3-déployer-proxysql-pour-la-gestion-des-connexions-et-de-mise-en-cache>3. Déployer ProxySQL pour la gestion des connexions et de mise en cache</h4><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: élevé</em></p><p>ProxySQL est un excellent outil pour aider à gérer le trafic MySQL, en particulier lors des pics de trafic. ProxySQL peut aider par exemple grâce au <a href=https://www.percona.com/resources/webinars/utilizing-proxysql-connection-pooling-php>pool de connexions</a> afin que l’application ne soit pas à court de connexions et ne surcharge pas MySQL en ayant trop de connexions simultanées.</p><p>Si vous exécutez <a href=https://www.percona.com/software/mysql-database/percona-server>Percona Server pour MySQL</a> ou MariaDB, vous pouvez également activer <a href=https://www.percona.com/doc/percona-server/LATEST/performance/threadpool.html>ThreadPool</a> qui peut permettre à une <a href=https://www.percona.com/blog/2019/02/25/mysql-challenge-100k-connections/>instance MySQL de gérer directement plus de 100 000 connexions</a>.</p><p>Une autre fonctionnalité de ProxySQL qui peut être encore plus utile lors des pics de trafic est <a href=https://www.percona.com/blog/2018/02/07/proxysql-query-cache/>ProxySQL Query Cache</a>, qui vous permet de mettre en cache les résultats des requêtes pendant un certain temps.</p><p>Lorsque vous trouvez des requêtes qui n’ont pas absolument besoin de fournir des résultats complètement à jour, dirigez-les vers des répliques MySQL où vous pouvez mettre en cache les mêmes requêtes pour un avantage supplémentaire.</p><p><strong>4. Désactiver les fonctionnalités des applications à charge lourde</strong></p><p><em>Complexité: moyenne</em></p><p><em>Impact potentiel: moyen</em></p><p>Les équipes de gestion et de développement détesteront souvent de telles idées, mais c’est un excellent outil. Toutes les fonctionnalités de l’application n’offrent pas la même valeur ou ne sont pas utilisées à la même fréquence, mais ce sont des fonctionnalités avancées, rarement appliquées, qui peuvent souvent être les plus coûteuses, car peu de temps a été passé à les optimiser. Les désactiver, au moins temporairement, pendant que vous traversez des pics de trafic ou que vous trouvez un moment pour les optimiser, est souvent une bonne chose à faire.</p><p>Il ne s’agit forcement pas des fonctionnalités destinées aux utilisateurs - pensez à identifier s’il existe des rapports internes dont vous pouvez vous passer?</p><h4 id=5-vérifiez-les-goulots-détranglement-des-ressources>5. Vérifiez les goulots d’étranglement des ressources</h4><p><em>Complexité: faible</em></p><p><em>Impact potentiel: élevé</em></p><p>Les bases de données de niveau matériel sont susceptibles d’être bloquées par une (ou plusieurs) ressources principales - CPU, mémoire, disque ou réseau. Si vous exécutez <a href=https://www.percona.com/software/database-tools/percona-monitoring-and-management>Percona Monitoring and Management (PMM</a>), vous pouvez les voir dans la section Récapitulatif des nœuds de votre tableau de bord récapitulatif des instances MySQL.</p><p><img src=/posts/article02/p01_image01.png alt="image 01"></p><p>Si une ressource particulière est saturée, vous pouvez généralement obtenir de meilleures performances en augmentant cette ressource, bien que se concentrer sur la réduction de l’utilisation de cette ressource soit une autre alternative. Par exemple, un problème d’utilisation élevée du processeur est souvent mieux résolu en optimisant vos requêtes plutôt qu’en obtenant un processeur plus rapide.</p><h4 id=6-obtenez-plus-de-cœurs-ou-des-cœurs-plus-rapides>6. Obtenez plus de cœurs ou des cœurs plus rapides</h4><p><em>Complexité: faible</em></p><p><em>Impact potentiel: moyen</em></p><p>Une chose importante à savoir à propos de MySQL est qu’il ne peut utiliser qu’un seul cœur de processeur pour effectuer la plupart du travail d’exécution d’une seule requête, ce qui signifie que l’obtention de plus de cœurs de processeur ne rend souvent pas vos requêtes lentes ou vos travaux par lots exécutant de nombreuses requêtes séquentiellement plus rapide. Si tel est votre problème, vous devez vous concentrer sur l’obtention de cœurs de processeur plus rapides ou vous devriez peut-être vous concentrer sur l’obtention de plus de cœurs.</p><p>Mais comment savoir quel type de charge de travail vous exécutez?</p><p>Jetez un œil à votre utilisation du processeur, à la saturation du processeur et à l’utilisation maximale du cœur dans le résumé des nœuds de Percona Monitoring and Management (ou graphique comparable dans votre système de surveillance préféré).</p><p><img src=/posts/article02/p01_image02.png alt="image 02"></p><p>Si l’utilisation du processeur est élevée (à l’exclusion de IO wait) et si la charge de processeur normalisée est supérieure ou égale à 2, votre système pourrait avoir besoin plus de cœurs de processeur disponibles pour exécuter un volume de travail.</p><p>Si, cependant, l’utilisation maximale du cœur du processeur est plus proche de 100% et que votre utilisation du processeur n’est pas élevée, vous devez vous concentrer sur des cœurs plus rapides.</p><p>Par exemple, si vous exécutez sur AWS, le <a href=https://aws.amazon.com/ec2/instance-types/>type d’instance</a> Cloud C5 offre des performances de processeur supérieures par rapport au type d’instance M5 à usage général.</p><p>Une autre chose à surveiller en ce qui concerne le processeur, en particulier dans le cloud et les environnements virtualisés, est le «vol de processeur» - cela peut laisser votre instance MySQL avec beaucoup moins de ressources processeur que la fréquence du processeur et le nombre de cœurs indiqué. Lisez «<a href=https://www.percona.com/blog/2019/11/04/choose-your-ec2-instance-type-wisely-on-aws/>Choisissez judicieusement votre type d’instance EC2 sur AWS</a>» pour plus de détails.</p><p>Page source : <a href=https://www.percona.com/blog/2020/04/03/18-things-you-can-do-to-remove-mysql-bottlenecks-caused-by-high-traffic-part-one/>Percona Blog</a></p><ul class=pa0><li class=list><a href=/tags/mysql class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">mysql</a></li></ul><div class="mt6 instapaper_ignoref"></div></div></article></main><footer class="bg-dark-blue bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://www.lesamisdepercona.fr/>&copy; Les amis de Percona 2021</a><div></div></div></footer></body></html>